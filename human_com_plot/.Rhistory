setwd("/home/anirjit/ANIRJIT/RESULTS/human_com_plot")
setwd("/home/anirjit/ANIRJIT/RESULTS/human_com_plot")
library(ggplot2)
# Get all files ending with "_plot" in the current directory
files <- list.files(pattern = "_plot$")
# Loop through each file and generate a heatmap
for (file in files) {
# Read data
A <- read.table(file=file, header=TRUE)
# Process data
F <- as.data.frame(table(round((A$Mutation_Percent / 10), 0),
round((A$Most_Frequent_AA_Percent / 10), 0)))
# Generate plot
p <- ggplot(F, aes(y = Var2, x = Var1, fill = Freq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "red", trans = "log",
breaks = c(1, 10, 100, 1000, max(F$Freq, na.rm = TRUE))) +
labs(title = paste("Heatmap of Sequence Counts for", file),
y = "Most Frequent AA Percent", x = "Entropy", fill = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Save plot as JPG
output_file <- paste0(file, ".jpg")
ggsave(output_file, plot = p, width = 6, height = 4, dpi = 300)
}
A
setwd("/home/anirjit/ANIRJIT/RESULTS/human_com_plot")
library(ggplot2)
# Get all files ending with "_plot" in the current directory
files <- list.files(pattern = "_plot$")
# Loop through each file and generate a heatmap
for (file in files) {
# Read data
A <- read.table(file=file, header=TRUE)
# Process data
F <- as.data.frame(table(round((A$Mutation_Percent / 10), 0),
round((A$Most_Frequent_AA_Percent / 10), 0)))
# Generate plot
p <- ggplot(F, aes(y = Var2, x = Var1, fill = Freq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "red", trans = "log",
breaks = c(1, 10, 100, 1000, max(F$Freq, na.rm = TRUE))) +
labs(title = paste("Heatmap of Sequence Counts for", file),
y = "Most Frequent AA Percent", x = "Mutation Percent", fill = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Save plot as JPG
output_file <- paste0(file, "_Mut_vs_AA.jpg")
ggsave(output_file, plot = p, width = 6, height = 4, dpi = 300)
}
setwd("/home/anirjit/ANIRJIT/RESULTS/human_com_plot")
library(ggplot2)
# Get all files ending with "_plot" in the current directory
files <- list.files(pattern = "_plot$")
# Loop through each file and generate a heatmap
for (file in files) {
# Read data
A <- read.table(file=file, header=TRUE)
# Process data
F <- as.data.frame(table(round((A$Entropy / 10), 0),
round((A$Most_Frequent_AA_Percent / 10), 0)))
# Generate plot
p <- ggplot(F, aes(y = Var2, x = Var1, fill = Freq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "red", trans = "log",
breaks = c(1, 10, 100, 1000, max(F$Freq, na.rm = TRUE))) +
labs(title = paste("Heatmap of Sequence Counts for", file),
y = "Most Frequent AA Percent", x = "Entropy", fill = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Save plot as JPG
output_file <- paste0(file, "_Ent_vs_AA.jpg")
ggsave(output_file, plot = p, width = 6, height = 4, dpi = 300)
}
head(A)
View(A)
A
