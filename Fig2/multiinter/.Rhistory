data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
#distinct_colors <- createPalette(num_colors, seedcolors = c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2"))
distinct_colors <- distinctColorPalette(50)
# Define patterns for each peptide type
data$Pattern <- case_when(
data$Peptide_Type == "Mono" ~ "none",  # Solid color
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
)
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "white",
pattern_density = 0.02,
pattern_spacing = 0.01,
pattern_size = 0.05) +
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none", "stripe", "crosshatch")) +
labs(title = "Stacked Bar Plot with Color and Patterns",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Pattern Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
data
View(data)
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
#distinct_colors <- createPalette(num_colors, seedcolors = c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2"))
distinct_colors <- distinctColorPalette(50)
# Define patterns for each peptide type
data$Pattern <- case_when(
data$Peptide_Type == "Mono" ~ "anone",  # Solid color
data$Peptide_Type == "Di" ~ "bstripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
)
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "white",
pattern_density = 0.02,
pattern_spacing = 0.01,
pattern_size = 0.05) +
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none", "stripe", "crosshatch")) +
labs(title = "Stacked Bar Plot with Color and Patterns",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Pattern Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
#distinct_colors <- createPalette(num_colors, seedcolors = c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2"))
distinct_colors <- distinctColorPalette(50)
# Define patterns for each peptide type
data$Pattern <- case_when(
data$Peptide_Type == "Mono" ~ "none",  # Solid color
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
)
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "white",
pattern_density = 0.02,
pattern_spacing = 0.01,
pattern_size = 0.05) +
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none", "stripe", "crosshatch")) +
labs(title = "Stacked Bar Plot with Color and Patterns",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Pattern Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
distinct_colors <- distinctColorPalette(num_colors)
# Define patterns for each peptide type (Convert to factor)
data$Pattern <- factor(case_when(
data$Peptide_Type == "Mono" ~ "none",  # No pattern
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
), levels = c("none", "stripe", "crosshatch"))  # Ensure correct ordering
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "white",
pattern_density = 0.1,   # Adjusted for better visibility
pattern_spacing = 0.02,  # Adjusted for thinner patterns
pattern_size = 0.3) +    # Makes patterns finer
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch")) +
labs(title = "Stacked Bar Plot with Color and Patterns",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Pattern Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
guides(pattern = guide_legend(override.aes = list(fill = "white")))  # Fix pattern legend display
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
distinct_colors <- distinctColorPalette(num_colors)
# Define patterns for each peptide type (Convert to factor)
data$Pattern <- factor(case_when(
data$Peptide_Type == "Mono" ~ "none",  # No pattern
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
), levels = c("none", "stripe", "crosshatch"))  # Ensure correct ordering
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "white",
pattern_density = 0.02,   # Adjusted for better visibility
pattern_spacing = 0.01,  # Adjusted for thinner patterns
pattern_size = 0.05) +    # Makes patterns finer
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch")) +
labs(title = "Stacked Bar Plot with Color and Patterns",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Pattern Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
guides(pattern = guide_legend(override.aes = list(fill = "white")))  # Fix pattern legend display
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
distinct_colors <- distinctColorPalette(num_colors)
# Define patterns for each peptide type (Convert to factor)
data$Pattern <- factor(case_when(
data$Peptide_Type == "Mono" ~ "none",  # No pattern
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
), levels = c("none", "stripe", "crosshatch"))  # Ensure correct ordering
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "white",
pattern_density = 0.02,   # Adjusted for better visibility
pattern_spacing = 0.01,  # Adjusted for thinner patterns
pattern_size = 0.1) +    # Makes patterns finer
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch")) +
labs(title = "Stacked Bar Plot with Color and Patterns",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Pattern Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
guides(pattern = guide_legend(override.aes = list(fill = "white")))  # Fix pattern legend display
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
distinct_colors <- distinctColorPalette(num_colors)
# Define patterns for each peptide type (Convert to factor)
data$Pattern <- factor(case_when(
data$Peptide_Type == "Mono" ~ "none",  # No pattern
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
), levels = c("none", "stripe", "crosshatch"))  # Ensure correct ordering
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "white",
pattern_density = 0.02,   # Adjusted for better visibility
pattern_spacing = 0.01,  # Adjusted for thinner patterns
pattern_size = 0.1) +    # Makes patterns finer
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch")) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch"),
labels = c("none" = "Monopeptide", "stripe" = "Dipeptide", "crosshatch" = "Tripeptide")) +  # Renaming legend labels
labs(title = "Stacked Bar Plot with Color and Patterns",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Pattern Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
guides(pattern = guide_legend(override.aes = list(fill = "white")))  # Fix pattern legend display
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
distinct_colors <- distinctColorPalette(num_colors)
# Define patterns for each peptide type (Convert to factor)
data$Pattern <- factor(case_when(
data$Peptide_Type == "Mono" ~ "none",  # No pattern
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
), levels = c("none", "stripe", "crosshatch"))  # Ensure correct ordering
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "black",
pattern_density = 0.02,   # Adjusted for better visibility
pattern_spacing = 0.01,  # Adjusted for thinner patterns
pattern_size = 0.2) +    # Makes patterns finer
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch")) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch"),
labels = c("none" = "Monopeptide", "stripe" = "Dipeptide", "crosshatch" = "Tripeptide")) +  # Renaming legend labels
labs(title = "Stacked Bar Plot with Color and Patterns",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Pattern Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
guides(pattern = guide_legend(override.aes = list(fill = "white")))  # Fix pattern legend display
setwd("/home/anirjit/ANIRJIT/RESULTS/multiinter")
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
distinct_colors <- distinctColorPalette(num_colors)
# Define patterns for each peptide type (Convert to factor)
data$Pattern <- factor(case_when(
data$Peptide_Type == "Mono" ~ "none",  # No pattern
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
), levels = c("none", "stripe", "crosshatch"))  # Ensure correct ordering
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "black",
pattern_density = 0.02,
pattern_spacing = 0.01,
pattern_size = 0.2) +
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch"),
labels = c("none" = "Monopeptide", "stripe" = "Dipeptide", "crosshatch" = "Tripeptide")) +  # Renaming legend labels
labs(title = "Stacked Bar Plot with Color and Patterns",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Peptide Type") +  # Change legend title to "Peptide Type"
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
guides(
fill = guide_legend(override.aes = list(pattern = "none")),  # Ensure Peptide legend has no patterns
pattern = guide_legend(override.aes = list(fill = "white"))  # Keep patterns in the Peptide Type legend
)
setwd("/home/anirjit/ANIRJIT/RESULTS/multiinter")
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
distinct_colors <- distinctColorPalette(num_colors)
# Define patterns for each peptide type (Convert to factor)
data$Pattern <- factor(case_when(
data$Peptide_Type == "Mono" ~ "none",  # No pattern
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
), levels = c("none", "stripe", "crosshatch"))  # Ensure correct ordering
jpeg(filename = "top20_multiinter.jpg", width = 6000, height = 4500, res = 200)
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "black",
pattern_density = 0.02,
pattern_spacing = 0.01,
pattern_size = 0.2) +
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch"),
labels = c("none" = "Monopeptide", "stripe" = "Dipeptide", "crosshatch" = "Tripeptide")) +  # Renaming legend labels
labs(title = "Most common peptides detected in LCRs across intersections of various tools",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Peptide Type") +  # Change legend title to "Peptide Type"
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
guides(
fill = guide_legend(override.aes = list(pattern = "none")),  # Ensure Peptide legend has no patterns
pattern = guide_legend(override.aes = list(fill = "white"))  # Keep patterns in the Peptide Type legend
)
dev.off()
setwd("/home/anirjit/ANIRJIT/RESULTS/multiinter")
library(ggplot2)
library(ggpattern)  # For adding patterns
library(dplyr)
library(Polychrome) # For distinct colors
# Read data
data <- read.delim("top_20.csv", header = TRUE, sep = "\t")
# Convert columns to factors
data$No..of.Tools <- factor(data$No..of.Tools)
# Assign peptide types (Mono, Di, Tri)
data$Peptide_Type <- case_when(
grepl("^[A-Z]$", data$Best.Peptide) ~ "Mono",  # Single-letter = Mono
grepl("^[A-Z]{2}$", data$Best.Peptide) ~ "Di",  # Two-letter = Di
grepl("^[A-Z]{3}$", data$Best.Peptide) ~ "Tri",  # Three-letter = Tri
TRUE ~ "Other"
)
# Ensure "Remaining" is at the top
data$Best.Peptide <- factor(data$Best.Peptide, levels = c(setdiff(unique(data$Best.Peptide), "Remaining"), "Remaining"))
# Generate distinct colors
num_colors <- length(unique(data$Best.Peptide))
distinct_colors <- distinctColorPalette(num_colors)
# Define patterns for each peptide type (Convert to factor)
data$Pattern <- factor(case_when(
data$Peptide_Type == "Mono" ~ "none",  # No pattern
data$Peptide_Type == "Di" ~ "stripe",  # Black stripes
data$Peptide_Type == "Tri" ~ "crosshatch",  # White stripes
TRUE ~ "none"
), levels = c("none", "stripe", "crosshatch"))  # Ensure correct ordering
jpeg(filename = "top20_multiinter.jpg", width = 6000, height = 4500, res = 500)
# Create stacked bar plot
ggplot(data, aes(x = No..of.Tools, y = Proportion, fill = Best.Peptide, pattern = Pattern)) +
geom_bar_pattern(stat = "identity",
pattern_color = "black",
pattern_fill = "black",
pattern_density = 0.02,
pattern_spacing = 0.01,
pattern_size = 0.2) +
scale_fill_manual(values = distinct_colors) +
scale_pattern_manual(values = c("none" = "none", "stripe" = "stripe", "crosshatch" = "crosshatch"),
labels = c("none" = "Monopeptide", "stripe" = "Dipeptide", "crosshatch" = "Tripeptide")) +  # Renaming legend labels
labs(title = "Most common peptides detected in LCRs across intersections of various tools",
x = "Number of Tools",
y = "Proportion",
fill = "Peptide",
pattern = "Peptide Type") +  # Change legend title to "Peptide Type"
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
guides(
fill = guide_legend(override.aes = list(pattern = "none")),  # Ensure Peptide legend has no patterns
pattern = guide_legend(override.aes = list(fill = "white"))  # Keep patterns in the Peptide Type legend
)
dev.off()
